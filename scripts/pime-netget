#!/bin/bash
url="$1"
host=$(echo "$url" | sed -E 's_https?://([^/]+).*_\1_')
path=$(echo "$url" | sed -E 's_https?://[^/]+(/.*)?_\1_')
path=${path:-/}

{
    echo "GET $path HTTP/1.1"
    echo "Host: $host"
    echo "User-Agent: pimenetget/1.0"
    echo "Connection: close"
    echo
} | openssl s_client -quiet -connect "$host:443" 2>/dev/null |
    awk 'BEGIN{found=0} 
        found{ print }
        /^(\r)?$/ { found=1 }'